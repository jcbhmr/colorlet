<script type="module">
  import greenlet from "../src/greenlet.js";
  import assert from "https://esm.sh/assert";
  import esmurl from "https://esm.run/esmurl";

  const tests = [];
  function test(n, f) {
    tests.push([n, f]);
  }
  window.onload = async () => {
    for (const [n, f] of tests) {
      try {
        await f();
        log.innerHTML += `<span style="color: green">${n} OK</span>\n`;
      } catch (e) {
        log.innerHTML += `<span style="color: red">${n} FAIL</span>\n`;
        console.error(n, e);
      }
    }
  };

  test("greenlet(esmurl())", async () => {
    const u = esmurl(import.meta, async () => {
      const { default: isOdd } = await import("https://esm.run/is-odd");
      return isOdd;
    });
    const remoteIsOdd = greenlet(u);

    assert.equal(await remoteIsOdd(1), true);
  });
</script>
<pre id="log" style="font-size: 2rem"></pre>
